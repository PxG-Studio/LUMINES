"use strict";(()=>{var e={};e.id=2996,e.ids=[2996],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},68385:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>d,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p});var s={};r.r(s),r.d(s,{GET:()=>l});var n=r(49303),i=r(88716),a=r(60670),o=r(87070),u=r(12657),c=r(89708);async function l(){try{let e=u.qI.exportPrometheus(),t=o.NextResponse.text(e,{headers:{"Content-Type":"text/plain; version=0.0.4"}});return(0,c.vm)(t,{noCache:!0})}catch(e){return console.error("Error exporting metrics:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/metrics/route",pathname:"/api/metrics",filename:"route",bundlePath:"app/api/metrics/route"},resolvedPagePath:"/home/cursor-dev/Documents/Lumines/src/app/api/metrics/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:p,serverHooks:g}=h,d="/api/metrics/route";function f(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},89708:(e,t,r)=>{r.d(t,{af:()=>i,vm:()=>a});let s={"X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin","Permissions-Policy":"geolocation=(), microphone=(), camera=()"},n={...s,"Strict-Transport-Security":"max-age=31536000; includeSubDomains","Content-Security-Policy":"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"};function i(e,t=3600,r=!1,s=!1){let n=[];return r?n.push("public"):n.push("private"),n.push(`max-age=${t}`),s&&n.push("must-revalidate"),e.headers.set("Cache-Control",n.join(", ")),e}function a(e,t={}){let{isProduction:r=!0,version:a="1.0.0",noCache:o=!0,cacheMaxAge:u=0}=t;return(function(e,t=!1){for(let[r,i]of Object.entries(t?n:s))i&&e.headers.set(r,i)}(e,r),function(e,t="1.0.0"){e.headers.set("X-API-Version",t)}(e,a),o)?(e.headers.set("Cache-Control","no-store, no-cache, must-revalidate, proxy-revalidate"),e.headers.set("Pragma","no-cache"),e.headers.set("Expires","0")):u>0&&i(e,u,!1,!0),e}},12657:(e,t,r)=>{r.d(t,{qI:()=>n});class s{incrementCounter(e,t,r=1){let s=this.getMetricKey(e,t),n=this.counters.get(s);n?n.value+=r:this.counters.set(s,{name:e,value:r,labels:t})}recordHistogram(e,t,r){let s=this.getMetricKey(e,r),n=this.histograms.get(s)||[];n.push({name:e,value:t,labels:r}),n.length>1e3&&n.shift(),this.histograms.set(s,n)}setGauge(e,t,r){let s=this.getMetricKey(e,r);this.gauges.set(s,t)}getCounter(e,t){let r=this.getMetricKey(e,t);return this.counters.get(r)?.value||0}getHistogramStats(e,t){let r=this.getMetricKey(e,t),s=this.histograms.get(r)||[];if(0===s.length)return null;let n=s.map(e=>e.value),i=n.reduce((e,t)=>e+t,0);return{count:s.length,sum:i,min:Math.min(...n),max:Math.max(...n),avg:i/s.length}}exportPrometheus(){let e=[];for(let[t,r]of this.counters.entries()){let t=this.formatLabels(r.labels);e.push(`# TYPE ${r.name} counter`),e.push(`${r.name}${t} ${r.value}`)}for(let[t,r]of this.histograms.entries()){if(0===r.length)continue;let t=this.formatLabels(r[0].labels),s=this.getHistogramStats(r[0].name,r[0].labels);s&&(e.push(`# TYPE ${r[0].name} histogram`),e.push(`${r[0].name}_count${t} ${s.count}`),e.push(`${r[0].name}_sum${t} ${s.sum}`),e.push(`${r[0].name}_min${t} ${s.min}`),e.push(`${r[0].name}_max${t} ${s.max}`),e.push(`${r[0].name}_avg${t} ${s.avg}`))}for(let[t,r]of this.gauges.entries()){let s=t.split("{")[0],n=t.includes("{")?`{${t.split("{")[1]}`:"";e.push(`# TYPE ${s} gauge`),e.push(`${s}${n} ${r}`)}return e.join("\n")+"\n"}reset(){this.counters.clear(),this.histograms.clear(),this.gauges.clear()}getMetricKey(e,t){if(!t||0===Object.keys(t).length)return e;let r=Object.entries(t).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>`${e}="${t}"`).join(",");return`${e}{${r}}`}formatLabels(e){if(!e||0===Object.keys(e).length)return"";let t=Object.entries(e).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>`${e}="${t}"`).join(",");return`{${t}}`}constructor(){this.counters=new Map,this.histograms=new Map,this.gauges=new Map}}let n=new s}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972],()=>r(68385));module.exports=s})();