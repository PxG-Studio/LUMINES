let d=!1,r=null;function u(o){return r||(d&&window.createUnityInstance?Promise.resolve():(r=new Promise((s,t)=>{const e=[`${o}/Build/build.loader.js`,`${o}/Build/Build.loader.js`,`${o}/Build/UnityLoader.js`,`${o}/Build/[ProjectName].loader.js`],n=e.length,l=i=>{if(i>=n){t(new Error(`Failed to load Unity loader. Tried ${n} paths.`)),r=null;return}const a=document.createElement("script");a.src=e[i],a.onload=()=>{d=!0,r=null,window.createUnityInstance?s():l(i+1)},a.onerror=()=>{l(i+1)},document.head.appendChild(a)};l(0)}),r))}const c=class c{static async loadInto(s,t,e){if(this.instance){try{typeof this.instance.Quit=="function"&&this.instance.Quit()}catch(a){console.warn("Error quitting Unity instance:",a)}this.instance=null}this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),s.innerHTML="",this.canvas=document.createElement("canvas"),this.canvas.id="unity-canvas",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",s.appendChild(this.canvas),this.buildUrl=t,await u(t);const n=window.createUnityInstance;if(!n)throw new Error("Unity loader did not register createUnityInstance. Make sure the loader script loaded correctly.");const i={...{dataUrl:`${t}/Build/build.data`,frameworkUrl:`${t}/Build/build.framework.js`,codeUrl:`${t}/Build/build.wasm`,streamingAssetsUrl:`${t}/StreamingAssets`,companyName:"WISSIL",productName:"Unity WebGL Build",productVersion:"1.0.0"},...e};try{return this.instance=await n(this.canvas,i),this.instance}catch(a){throw this.instance=null,this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),a}}static postMessageToUnity(s,t,e){if(!this.instance){console.warn("Unity instance not loaded. Cannot send message.");return}try{const n=typeof e=="string"?e:JSON.stringify(e);typeof this.instance.SendMessage=="function"?this.instance.SendMessage(s,t,n):console.warn("Unity instance does not support SendMessage")}catch(n){console.error("Error sending message to Unity:",n)}}static getInstance(){return this.instance}static isLoaded(){return this.instance!==null}static destroy(){if(this.instance){try{typeof this.instance.Quit=="function"&&this.instance.Quit()}catch(s){console.warn("Error quitting Unity instance:",s)}this.instance=null}this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.buildUrl=null}static getBuildUrl(){return this.buildUrl}};c.instance=null,c.canvas=null,c.buildUrl=null;let h=c;export{h as U};
