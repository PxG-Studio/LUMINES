import{c as a}from"./iframe-BXkX_8oL.js";function c(o){return o.replace(/^\//,"").split("/").filter(Boolean)}function p(o){const n=c(o),r=[];for(const e of n)e!=="."&&(e===".."?r.pop():r.push(e));return r.join("/")}function u(...o){return o.filter(Boolean).join("/").replace(/\/+/g,"/")}function s(o,n){if(n.length===0)return o;const[r,...e]=n;o.children[r]||(o.children[r]={type:"folder",children:{}});const t=o.children[r];if(t.type!=="folder")throw new Error(`Cannot create folder: ${r} already exists as a file`);return s(t,e)}function f(o,n){let r=o;for(const e of n){if(r.type!=="folder")return null;const t=r.children[e];if(!t||t.type!=="folder")return null;r=t}return r.type==="folder"?r:null}const h=a((o,n)=>({root:{type:"folder",children:{}},writeFile:(r,e)=>{const t=c(r);if(t.length===0)throw new Error("Cannot write to root path");const l=t.pop(),i=s(n().root,t);i.children[l]={type:"file",content:e},o({root:{...n().root}})},readFile:r=>{const e=c(r);if(e.length===0)return null;const t=e.pop(),l=f(n().root,e);if(!l)return null;const i=l.children[t];return!i||i.type!=="file"?null:i.content},deleteFile:r=>{const e=c(r);if(e.length===0)return;const t=e.pop(),l=f(n().root,e);l&&(delete l.children[t],o({root:{...n().root}}))},exists:r=>{const e=c(r);if(e.length===0)return!0;const t=e.pop(),l=f(n().root,e);return l?t in l.children:!1},createFolder:r=>{const e=c(r);e.length!==0&&(s(n().root,e),o({root:{...n().root}}))},deleteFolder:r=>{const e=c(r);if(e.length===0){o({root:{type:"folder",children:{}}});return}const t=e.pop(),l=f(n().root,e);if(!l)return;const i=l.children[t];!i||i.type!=="folder"||(delete l.children[t],o({root:{...n().root}}))},listDirectory:r=>{const e=c(r),t=f(n().root,e);return t?Object.keys(t.children):[]},getSnapshot:()=>JSON.parse(JSON.stringify(n().root)),hydrate:r=>{o({root:r})},clear:()=>{o({root:{type:"folder",children:{}}})}}));export{u as j,p as n,h as u};
