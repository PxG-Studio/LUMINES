"use strict";(self.webpackChunklumines_wissil=self.webpackChunklumines_wissil||[]).push([[8654],{"./.storybook/UnityPreviewDecorator.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{V:()=>UnityPreviewDecorator});var _home_runner_work_LUMINES_LUMINES_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_LUMINES_LUMINES_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_LUMINES_LUMINES_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_home_runner_work_LUMINES_LUMINES_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_1__),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_wissil_IgnisWebGL_unityBridge__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/wissil/IgnisWebGL/unityBridge.ts"),_design_system_themes_ThemeProvider__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/design-system/themes/ThemeProvider.tsx"),__jsx=react__WEBPACK_IMPORTED_MODULE_2__.createElement;function UnityPreviewDecorator(_ref){var _theme$radii,_ref$buildUrl=_ref.buildUrl,buildUrl=void 0===_ref$buildUrl?"/UnityBuild":_ref$buildUrl,_ref$enabled=_ref.enabled,enabled=void 0===_ref$enabled||_ref$enabled,_ref$height=_ref.height,height=void 0===_ref$height?500:_ref$height,children=_ref.children,theme=(0,_design_system_themes_ThemeProvider__WEBPACK_IMPORTED_MODULE_4__.D)(),containerRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null),_useState=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1),loading=_useState[0],setLoading=_useState[1],_useState2=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null),error=_useState2[0],setError=_useState2[1];return(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(function(){if(enabled&&containerRef.current){var active=!0;return setLoading(!0),setError(null),function loadUnity(){return _loadUnity.apply(this,arguments)}(),function(){active=!1,_wissil_IgnisWebGL_unityBridge__WEBPACK_IMPORTED_MODULE_3__.D.destroy()}}function _loadUnity(){return(_loadUnity=(0,_home_runner_work_LUMINES_LUMINES_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__.A)(_home_runner_work_LUMINES_LUMINES_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_1___default().mark(function _callee(){var _t;return _home_runner_work_LUMINES_LUMINES_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_1___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=1,_wissil_IgnisWebGL_unityBridge__WEBPACK_IMPORTED_MODULE_3__.D.loadInto(containerRef.current,buildUrl);case 1:active&&setLoading(!1),_context.next=3;break;case 2:_context.prev=2,_t=_context.catch(0),active&&(setError((null==_t?void 0:_t.message)||String(_t)),setLoading(!1));case 3:case"end":return _context.stop()}},_callee,null,[[0,2]])}))).apply(this,arguments)}},[buildUrl,enabled]),__jsx("div",{style:{padding:20}},__jsx("div",{ref:containerRef,style:{width:"100%",height:"number"==typeof height?"".concat(height,"px"):height,background:theme.colors.bg2||"#111",borderRadius:(null===(_theme$radii=theme.radii)||void 0===_theme$radii?void 0:_theme$radii.md)||8,border:"1px solid ".concat(theme.colors.border||"#333"),position:"relative",overflow:"hidden",marginBottom:20}},loading&&__jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:theme.colors.text2||"#888",fontSize:14}},"Loading Unity WebGL..."),error&&__jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:theme.colors.error||"#f44",fontSize:14,padding:20,textAlign:"center"}},"Unity Load Error: ",error)),children&&__jsx("div",{style:{marginTop:20}},children))}function withUnityPreview(Story,context){var _context$args,_context$args2,buildUrl=(null===(_context$args=context.args)||void 0===_context$args?void 0:_context$args.buildUrl)||"/UnityBuild",enabled=!1!==(null===(_context$args2=context.args)||void 0===_context$args2?void 0:_context$args2.unityEnabled);return __jsx(UnityPreviewDecorator,{buildUrl,enabled},__jsx(Story,context))}UnityPreviewDecorator.displayName="UnityPreviewDecorator",withUnityPreview.displayName="withUnityPreview";try{UnityPreviewDecorator.displayName="UnityPreviewDecorator",UnityPreviewDecorator.__docgenInfo={description:"Unity Preview Decorator for Storybook stories\nWraps stories with Unity WebGL preview",displayName:"UnityPreviewDecorator",props:{buildUrl:{defaultValue:{value:"/UnityBuild"},description:"",name:"buildUrl",required:!1,type:{name:"string | undefined"}},enabled:{defaultValue:{value:"true"},description:"",name:"enabled",required:!1,type:{name:"boolean | undefined"}},height:{defaultValue:{value:"500"},description:"",name:"height",required:!1,type:{name:"string | number | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES[".storybook/UnityPreviewDecorator.tsx#UnityPreviewDecorator"]={docgenInfo:UnityPreviewDecorator.__docgenInfo,name:"UnityPreviewDecorator",path:".storybook/UnityPreviewDecorator.tsx#UnityPreviewDecorator"})}catch(__react_docgen_typescript_loader_error){}try{withUnityPreview.displayName="withUnityPreview",withUnityPreview.__docgenInfo={description:"Storybook decorator function",displayName:"withUnityPreview",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES[".storybook/UnityPreviewDecorator.tsx#withUnityPreview"]={docgenInfo:withUnityPreview.__docgenInfo,name:"withUnityPreview",path:".storybook/UnityPreviewDecorator.tsx#withUnityPreview"})}catch(__react_docgen_typescript_loader_error){}},"./src/stories/unity/CardFront/CardFrontScene.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CardFrontScene:()=>CardFrontScene,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),storybook_decorator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./.storybook/UnityPreviewDecorator.tsx"),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;const __WEBPACK_DEFAULT_EXPORT__={title:"Lumenforge.io Design System/WIS2L Framework/Unity Bridge/CardFront/CardFrontScene",component:function component(){return null},decorators:[function(Story,context){return __jsx(storybook_decorator__WEBPACK_IMPORTED_MODULE_1__.V,{buildUrl:"/UnityBuild",enabled:!0},__jsx(Story,context))}],parameters:{layout:"padded"}};var CardFrontScene={render:function render(){return __jsx("div",null,__jsx("h3",{style:{marginTop:0,marginBottom:12}},"CardFront Scene"),__jsx("p",{style:{margin:0,opacity:.8}},"Preview of the CardFront Unity scene inside Storybook. This includes the board layout, camera, and UI elements."),__jsx("ul",{style:{marginTop:12,paddingLeft:20,opacity:.8}},__jsx("li",null,"Board plane"),__jsx("li",null,"Card zone transforms"),__jsx("li",null,"Camera rig"),__jsx("li",null,"UI canvas")))}};CardFrontScene.parameters={...CardFrontScene.parameters,docs:{...CardFrontScene.parameters?.docs,source:{originalSource:"{\n  render: () => <div>\n      <h3 style={{\n      marginTop: 0,\n      marginBottom: 12\n    }}>CardFront Scene</h3>\n      <p style={{\n      margin: 0,\n      opacity: 0.8\n    }}>\n        Preview of the CardFront Unity scene inside Storybook. This includes the board layout, camera, and UI elements.\n      </p>\n      <ul style={{\n      marginTop: 12,\n      paddingLeft: 20,\n      opacity: 0.8\n    }}>\n        <li>Board plane</li>\n        <li>Card zone transforms</li>\n        <li>Camera rig</li>\n        <li>UI canvas</li>\n      </ul>\n    </div>\n}",...CardFrontScene.parameters?.docs?.source}}};const __namedExportsOrder=["CardFrontScene"]},"./src/wissil/IgnisWebGL/unityBridge.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>UnityBridge});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),loaderLoaded=!1,loaderPromise=null;function loadUnityLoader(buildUrl){return loaderPromise||(loaderLoaded&&window.createUnityInstance?Promise.resolve():loaderPromise=new Promise(function(resolve,reject){var loaderPaths=["".concat(buildUrl,"/Build/build.loader.js"),"".concat(buildUrl,"/Build/Build.loader.js"),"".concat(buildUrl,"/Build/UnityLoader.js"),"".concat(buildUrl,"/Build/[ProjectName].loader.js")],maxAttempts=loaderPaths.length,_tryLoad=function tryLoad(index){if(index>=maxAttempts)return reject(new Error("Failed to load Unity loader. Tried ".concat(maxAttempts," paths."))),void(loaderPromise=null);var script=document.createElement("script");script.src=loaderPaths[index],script.onload=function(){loaderLoaded=!0,loaderPromise=null,window.createUnityInstance?resolve():_tryLoad(index+1)},script.onerror=function(){_tryLoad(index+1)},document.head.appendChild(script)};_tryLoad(0)}))}var console=__webpack_require__("./node_modules/console-browserify/index.js");function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){(0,defineProperty.A)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var UnityBridge=function(){return(0,createClass.A)(function UnityBridge(){(0,classCallCheck.A)(this,UnityBridge)},null,[{key:"loadInto",value:(_loadInto=(0,asyncToGenerator.A)(regenerator_default().mark(function _callee2(container,buildUrl,config){var createUnityInstance,defaultConfig,finalConfig,_t2,_this=this;return regenerator_default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(this.instance){try{"function"==typeof this.instance.Quit&&this.instance.Quit()}catch(err){console.warn("Error quitting Unity instance:",err)}this.instance=null}return this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),container.innerHTML="",this.canvas=document.createElement("canvas"),this.canvas.id="unity-canvas",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",container.appendChild(this.canvas),this.buildUrl=buildUrl,_context2.next=1,loadUnityLoader(buildUrl);case 1:if(createUnityInstance=window.createUnityInstance){_context2.next=2;break}throw new Error("Unity loader did not register createUnityInstance. Make sure the loader script loaded correctly.");case 2:return defaultConfig={dataUrl:"".concat(buildUrl,"/Build/build.data"),frameworkUrl:"".concat(buildUrl,"/Build/build.framework.js"),codeUrl:"".concat(buildUrl,"/Build/build.wasm"),streamingAssetsUrl:"".concat(buildUrl,"/StreamingAssets"),companyName:"WISSIL",productName:"Unity WebGL Build",productVersion:"1.0.0"},finalConfig=_objectSpread(_objectSpread({},defaultConfig),config),_context2.prev=3,_context2.next=4,createUnityInstance(this.canvas,finalConfig);case 4:return this.instance=_context2.sent,"undefined"!=typeof window&&setTimeout((0,asyncToGenerator.A)(regenerator_default().mark(function _callee(){var _t;return regenerator_default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=1,__webpack_require__.e(9559).then(__webpack_require__.bind(__webpack_require__,"./src/wissil/runtime/unityBridge/UnityMessagingBus.ts"));case 1:return _context.sent.UnityMessagingBus.setUnityInstance(_this.instance),_context.next=2,__webpack_require__.e(1189).then(__webpack_require__.bind(__webpack_require__,"./src/wissil/runtime/unityBridge/RuntimeEvents.ts"));case 2:(0,_context.sent.setupUnityEventListeners)(),_context.next=4;break;case 3:_context.prev=3,_t=_context.catch(0),console.warn("[UnityBridge] Failed to set up messaging bus:",_t);case 4:case"end":return _context.stop()}},_callee,null,[[0,3]])})),0),_context2.abrupt("return",this.instance);case 5:throw _context2.prev=5,_t2=_context2.catch(3),this.instance=null,this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),_t2;case 6:case"end":return _context2.stop()}},_callee2,this,[[3,5]])})),function loadInto(_x,_x2,_x3){return _loadInto.apply(this,arguments)})},{key:"postMessageToUnity",value:function postMessageToUnity(gameObject,method,message){if(this.instance)try{var messageStr="string"==typeof message?message:JSON.stringify(message);"function"==typeof this.instance.SendMessage?this.instance.SendMessage(gameObject,method,messageStr):console.warn("Unity instance does not support SendMessage")}catch(err){console.error("Error sending message to Unity:",err)}else console.warn("Unity instance not loaded. Cannot send message.")}},{key:"getInstance",value:function getInstance(){return this.instance}},{key:"isLoaded",value:function isLoaded(){return null!==this.instance}},{key:"destroy",value:function destroy(){if("undefined"!=typeof window&&Promise.all([__webpack_require__.e(9559).then(__webpack_require__.bind(__webpack_require__,"./src/wissil/runtime/unityBridge/UnityMessagingBus.ts")).then(function(_ref2){_ref2.UnityMessagingBus.reset()}).catch(function(){}),__webpack_require__.e(1189).then(__webpack_require__.bind(__webpack_require__,"./src/wissil/runtime/unityBridge/RuntimeEvents.ts")).then(function(_ref3){(0,_ref3.cleanupUnityEventListeners)()}).catch(function(){})]).catch(function(){}),this.instance){try{"function"==typeof this.instance.Quit&&this.instance.Quit()}catch(err){console.warn("Error quitting Unity instance:",err)}this.instance=null}this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.buildUrl=null}},{key:"getBuildUrl",value:function getBuildUrl(){return this.buildUrl}}]);var _loadInto}();(0,defineProperty.A)(UnityBridge,"instance",null),(0,defineProperty.A)(UnityBridge,"canvas",null),(0,defineProperty.A)(UnityBridge,"buildUrl",null)}}]);